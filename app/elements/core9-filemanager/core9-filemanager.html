<link rel="import" href="../core9-filedrop/core9-filedrop.html">

<dom-module id="core9-filemanager">
<link rel="stylesheet" href="core9-filemanager.css">
<link href="../../../bower_components/footable/css/footable.core.min.css" rel="stylesheet" type="text/css" />
<link href="../../../bower_components/footable/css/footable.metro.min.css" rel="stylesheet" type="text/css" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script> <script
	src="../../../bower_components/footable/dist/footable.all.min.js" type="text/javascript"
></script> <script src="../../../bower_components/footable/dist/footable.filter.min.js" type="text/javascript"></script>
<style>
:host {
	display: block;
	border: 0px solid grey;
	height: 100%;
	width: 96%;
}
core9-filedrop, core9-filedrop a {
            width: calc( 100%  );
            display: block;
            padding: 1em;
            margin: 1em;
            min-height: 1em;
            font-size: 1em;
            text-align: center;
            color: rgb(170, 170, 170);
            border: 1px solid black;
            border: 1px solid #ccc;
            border-radius: 3px;
            background-color: #fff;
            margin-left:0px;
}
</style>
<template>




<div>



    <!-- Using Custom Elements -->
    <core9-filedrop url="/storage/server/path" maxfilesize="524288" allowedmimetypes="image/jpeg,image/png">
        <div>
            Hey, drop some file at me!
        </div>
        <div>
            <a href="javascript:" id="aSelectFile">Or select file from your computer!</a>
        </div>
    </core9-filedrop>

    <!-- Handling its events -->
    <script>
        (function () {
            var filedrop = document.querySelector("core9-filedrop");

            // Upload started
            filedrop.addEventListener("fileUploading", function (ev) {
                console.log("Uploading started", ev.detail);
            });

            // File successfully uploaded
            filedrop.addEventListener("fileUploaded", function (ev) {
                alert("File uploaded, and saved as `" + ev.detail.name + "`\n" + "See console for details.");
                console.info("File uploaded, and saved as ", ev.detail.name, ev.detail);
            });
            // Upload failed
            filedrop.addEventListener("fileUploadError", function (ev) {
                console.warn("Upload error! ", ev.detail);
            });

            filedrop.addEventListener("fileSelectError", function (ev) {
                console.warn("Select file error!", ev.detail.message);
            });

            document.getElementById("aSelectFile").addEventListener("click", function () {
                filedrop.openFile();
            });
        }());
    </script>







<div class="input-field col s5">
	 <input id="filter" type="text" />
		<label>Search:</label>
</div>
		<div class="input-field col s5">
		 <select id="filterstatus" class="filter-status">
			<option></option>
			<option value="active">Active</option>
			<option value="disabled">Disabled</option>
			<option value="suspended">Suspended</option>
		</select>
		<label>Status:</label>
		</div>
<script>
$(document).ready(function() {
    $('select').material_select();
  });
</script>

	<table id="table2" class="table" data-filter="#filter" data-filter-minimum="3" data-filter-timeout="500"
		data-filter-text-only="true" data-page-size="5"
	>
		<thead>
			<tr>
				<th>First Name</th>
				<th>Last Name</th>
				<th data-hide="phone,tablet">Job Title</th>
				<th data-hide="phone,tablet">DOB</th>
				<th data-hide="phone">Status</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>Isidra</td>
				<td><a href="#">Boudreaux</a></td>
				<td>Traffic Court Referee</td>
				<td data-value="78025368997">22 Jun 1972</td>
				<td data-value="1"><span class="status-metro status-active" title="Active">Active</span></td>
			</tr>
			<tr>
				<td>Shona</td>
				<td>Woldt</td>
				<td><a href="#">Airline Transport Pilot</a></td>
				<td data-value="370961043292">3 Oct 1981</td>
				<td data-value="2"><span class="status-metro status-disabled" title="Disabled">Disabled</span></td>
			</tr>
			<tr>
				<td>Granville</td>
				<td>Leonardo</td>
				<td>Business Services Sales Representative</td>
				<td data-value="-22133780420">19 Apr 1969</td>
				<td data-value="3"><span class="status-metro status-suspended" title="Suspended">Suspended</span></td>
			</tr>
			<tr>
				<td>Easer</td>
				<td>Dragoo</td>
				<td>Drywall Stripper</td>
				<td data-value="250833505574">13 Dec 1977</td>
				<td data-value="1"><span class="status-metro status-active" title="Active">Active</span></td>
			</tr>
			<tr>
				<td>Maple</td>
				<td>Halladay</td>
				<td>Aviation Tactical Readiness Officer</td>
				<td data-value="694116650726">30 Dec 1991</td>
				<td data-value="3"><span class="status-metro status-suspended" title="Suspended">Suspended</span></td>
			</tr>
			<tr>
				<td>Maxine</td>
				<td><a href="#">Woldt</a></td>
				<td><a href="#">Business Services Sales Representative</a></td>
				<td data-value="561440464855">17 Oct 1987</td>
				<td data-value="2"><span class="status-metro status-disabled" title="Disabled">Disabled</span></td>
			</tr>
			<tr>
				<td>Lorraine</td>
				<td>Mcgaughy</td>
				<td>Hemodialysis Technician</td>
				<td data-value="437400551390">11 Nov 1983</td>
				<td data-value="2"><span class="status-metro status-disabled" title="Disabled">Disabled</span></td>
			</tr>
			<tr>
				<td>Lizzee</td>
				<td><a href="#">Goodlow</a></td>
				<td>Technical Services Librarian</td>
				<td data-value="-257733999319">1 Nov 1961</td>
				<td data-value="3"><span class="status-metro status-suspended" title="Suspended">Suspended</span></td>
			</tr>
			<tr>
				<td>Judi</td>
				<td>Badgett</td>
				<td>Electrical Lineworker</td>
				<td data-value="362134712000">23 Jun 1981</td>
				<td data-value="1"><span class="status-metro status-active" title="Active">Active</span></td>
			</tr>
			<tr>
				<td>Lauri</td>
				<td>Hyland</td>
				<td>Blackjack Supervisor</td>
				<td data-value="500874333932">15 Nov 1985</td>
				<td data-value="3"><span class="status-metro status-suspended" title="Suspended">Suspended</span></td>
			</tr>
		</tbody>
		<tfoot>
			<tr>
				<td colspan="5">
					<div class="pagination pagination-centered"></div>
				</td>
			</tr>
		</tfoot>
	</table>


	<content></content>
</div>
</template> </dom-module>

<script type="text/javascript">

</script>

<script>


	Core9.multiImport([ 'app/elements/core9-file/js/file' ])
			.then(
					function(modules) {

						//var restful = modules[0];
						var FILE = Core9.unwrapModule(modules[0]);

						Polymer({
							is : 'core9-filemanager',
							ready : function() {
								FILE.config({
									server : 'localhost',
									port : 8080,
									db : 'core9-backend',
									collection : 'files'
								});
								console.log(FILE.collectionExists());
                console.log(FILE);
								var table2 = this.$.table2;
								var statusFilter = this.$.filterstatus;
								var filter = this.$.filter;

								$(table2)
										.footable({
											breakpoints : {
												tiny : 100,
												medium : 555,
												big : 2048
											}
										})
										.bind(
												'footable_filtering',
												function(e) {

													var selected = $(
															statusFilter).find(
															':selected').text();
													if (selected
															&& selected.length > 0) {
														e.filter += (e.filter && e.filter.length > 0) ? ' '
																+ selected
																: selected;
														e.clear = !e.filter;
													}

												});

								$(statusFilter).change(function(e) {
									e.preventDefault();
									$(table2).trigger('footable_filter', {
										filter : $(statusFilter).val()
									});
								});

								$(filter).on('input', function() {
									$(table2).trigger('footable_filter', {
										filter : $(this).val()
									});
								});

							}
						});

					})
</script>